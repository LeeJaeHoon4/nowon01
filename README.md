# nowon01
이재훈
------------------------------------------------------------
회원 테이블, 게시글 테이블, 댓글 테이블 관계설정
회원 테이블의 pk를 게시글 테이블이 fk로 가짐 (pk는 아님)
게시글과 회원 테이블의 pk를 댓글 테이블이 가짐(pk는 아님)
게시글이 삭제되면 연관되어진 모든 댓글 테이블이 삭제됨
회원 테이블이 삭제되면 연관된 모든 게시글과 댓글 테이블이 삭제됨
-------------------------------------------------------------
회원 가입 설계 과정
1. pk와 아이디 비밀번호만 가지고 테이블 구성
2. JQuery를 사용한 정규식을 통해서 각 항목에 제약 조건을 걸어줌
3. 이후 이메일 과 이름 칼럼 추가
4. java MailSender를 이용해 이메일 인증을 구현
5. 이메일에 인증번호를 클립보드로 복사하는 button을 담아서 날리기로 함
6. 이메일 플랫폼에서 보안상의 이유로 javascript를 제한한다는 사실을 알게됨
7. 이후 Qr코드를 만들어서 이메일과 함께 보내기로함
8. Qr코드 이미지가 깨져서 첨부파일로 들어감
9. QR코드를 회원가입 페이지에 만들어서 삽입 하기로함
10. 이메일을 단시간에 여러번 인증 시도시 일정 시간동안 차단하는 기능을 구현하기로함
11. 물리 db에서는 구현하기 힘들어서 redis 를 도입하기로함
12. redis저장 객체에 있는 Duration 속성을 사용해 10번 인증 시도이후에는 5분간 딜레이를 가지도록 설정함
13. Google smtp를 사용하는데 이메일 발송에 3~5초 정도의 딜레이가 있음
14. 처음에는 메일이 언제 가는지 알려주기 위해 alert를 띄웠음
15. 그런데 이 딜레이가 문제가 되는 이유는 늦게 가서도 있지만 이메일을 보내는 동안 QR코드 이미지가 나타나지 않음
17. QR코드 이미지와 이메일 보내기를 하나의 서비스에서 처리했기 때문 그래서 2개를 분리 하기로함 
18. 분리 하는 동안 QR코드 이미지를 원래는 서비스 단에서 google zxing 라이브러리를 통해 만들었으나 javascript 라이브러리를 가지고와서 클라이언트 쪽에서 생성하도록 하기로함
19. Qr코드 이미지를 생성하기 위한 fetch 요청을 javascript 단에서 보냄
20. 이메일란에 적힌 이메일을 key로 해서 redis에 인증키와 인증횟수(다른키사용 이메일+문자열)를 각각 저장함
21. 성공시 콜백 함수로 이메일을 보내도록 조절함 만약 인증횟수가 넘어가거나 이메일이 잘못된경우 try catch문을 통해 error를 리턴하고 alert 띄워줌
22. 이후 회원 가입 처리가 완료됨
23. -----------------------------------------------------------------
24. 게시글 및 댓글 처리 설계 과정
25. 기본적으로 글 번호, 작성자,내용,작성일, 작성자의 memberEntity pK를 가지게 설계하였음
26. 기본적인 mvc2모델로 작성함
27. 게시글의 경우 Summernote API를 활용 하였음
28. 게시글 보기에 경우 summernote airmode를 통해 구현했음 ( 이렇게 해야 db에  summernoteAPI를 통해서 저장할때 들어간 태그 정보가 나타나지 않고 문서 내용으로 반영됨)
29. 게시글 수정의 경우 현재 로그인 된 계정의인증정보가 작성자와 일치 했을 경우 수정하기 버튼이 보이게 설계
30. 수정하기 버튼을 누르면 게시글 보기 페이지에 display none으로 설정 되어있는  또 다른 summernote가 나타남
31. 여기에 내용을 입력하면 ajax를 통해서 db에 저장되며 내용이 업데이트 되어서 화면에 표시됨
32. 게시글 삭제는 현재 로그인 된 계정의인증정보가 admin이상 이거나 작성자와 일치할때 수정 및 삭제 버튼이 나타나도록 설계함
33. 삭제 버튼을 누르면 삭제됨
34. 이후 댓글을 추가함
35. 댓글에 페이징 처리를 함
36. 댓글 삭제는 현재 로그인 된 계정의인증정보가 admin이상 이거나 작성자와 일치할때 삭제 버튼이 나타나도록 설계함
37. 버튼 누르면 비밀번호를 요구하는 팝업 창이 나타남 여기에 비밀 번호를 입력하면 ajax를 통해 db에 회원 정보와 일치하는지 확인 이후 삭제처리
38. 댓글 추가 및 삭제를 구현하고 즉각적으로 view에 반영 하기 위해서 기존에 페이지를 불러올때 model에 담아서 가져오던 정보를 ajax를 통해 페이지가 로딩 된 뒤에 불러오 도록 변경함---------------
------------------------------------------------------------------------
39. 보안설계 업데이트 및 css 없데이트
40. layer popup을 위한 sweetAlert2 적용(07/13)
41. bootstrap 5.0.0적용
42. Xss 공격 취약성 극복을 위해 naver lucy 적용
43. mybatis $선택자 사용시 sql인젝션 보안취약성 극복을 위해 sqlsafe라이브러리 적용
44. 
2023/07/06 목표  사항
1. 회원 탈퇴 구현 -- 구현예정
2. 회원 탈퇴, 게시글 및 댓글 삭제시 db에서 사라지는 것이 아니라 다른 isShow 칼럼을 만들어서 true일경우 보이게 아닐경우 안보이게 --완성
3. 삭제시 false로 설정 되도록 할것임 -----0703 적용완료
4. 카카오 및 구글 api를 통한 소셜 로그인 구현 --0706~0707 완성
5. 마스터 페이지 관리자 부여 기능 ----0706 완성
6. 어드민+마스터 페이지 신고 누적 게시글 삭제(안보이게) 처리 예정
7. 회원정보 수정 및 이메일 변경 탈퇴기능 한번에 구현 할 예정
